{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "background": "white",
  "padding": 5,
  "width": 500,
  "height": 300,
  "title": {"text": "Causes of Deaths in Malaysia (2016-2021)", "frame": "group"},
  "style": "None",
  "data": [
    {
      "name": "data",
      "values": [
        {"year": 2016, "cause": "Ischaemic heart disease", "rate": 106.97},
        {"year": 2016, "cause": "Stroke", "rate": 66.81},
        {"year": 2016, "cause": "Lower respiratory infections", "rate": 59.92},
        {"year": 2016, "cause": "Road injury", "rate": 23.1},
        {"year": 2016, "cause": "Kidney diseases", "rate": 21},
        {"year": 2016, "cause": "Chronic obstructive pulmonary disease", "rate": 17.35},
        {"year": 2016, "cause": "Cirrhosis of the liver", "rate": 14.29},
        {"year": 2016, "cause": "Diabetes mellitus", "rate": 14.05},
        {"year": 2016, "cause": "Alzheimer disease and other dementias", "rate": 12.72},
        {"year": 2016, "cause": "Lung cancers", "rate": 11.9},
        {"year": 2017, "cause": "Ischaemic heart disease", "rate": 123.76},
        {"year": 2017, "cause": "Stroke", "rate": 61.72},
        {"year": 2017, "cause": "Lower respiratory infections", "rate": 60.16},
        {"year": 2017, "cause": "Road injury", "rate": 33.95},
        {"year": 2017, "cause": "Chronic obstructive pulmonary disease", "rate": 22.22},
        {"year": 2017, "cause": "Kidney diseases", "rate": 19.65},
        {"year": 2017, "cause": "Cirrhosis of the liver", "rate": 19.3},
        {"year": 2017, "cause": "Lung cancers", "rate": 17.98},
        {"year": 2017, "cause": "HIV/AIDS", "rate": 13.12},
        {"year": 2017, "cause": "Diabetes mellitus", "rate": 12.18},
        {"year": 2018, "cause": "Ischaemic heart disease", "rate": 111.61},
        {"year": 2018, "cause": "Stroke", "rate": 69.1},
        {"year": 2018, "cause": "Lower respiratory infections", "rate": 60.81},
        {"year": 2018, "cause": "Road injury", "rate": 19.65},
        {"year": 2018, "cause": "Diabetes mellitus", "rate": 15.09},
        {"year": 2018, "cause": "Back and neck pain", "rate": 0},
        {"year": 2018, "cause": "Kidney diseases", "rate": 22.22},
        {"year": 2018, "cause": "Skin diseases", "rate": 6.12},
        {"year": 2018, "cause": "Depressive disorders", "rate": 0},
        {"year": 2018, "cause": "Migraine", "rate": 0},
        {"year": 2019, "cause": "Ischaemic heart disease", "rate": 112.34},
        {"year": 2019, "cause": "Stroke", "rate": 69.54},
        {"year": 2019, "cause": "Lower respiratory infections", "rate": 60.83},
        {"year": 2019, "cause": "Road injury", "rate": 19.05},
        {"year": 2019, "cause": "Diabetes mellitus", "rate": 15.49},
        {"year": 2019, "cause": "Back and neck pain", "rate": 0},
        {"year": 2019, "cause": "Kidney diseases", "rate": 22.78},
        {"year": 2019, "cause": "Skin diseases", "rate": 6.2},
        {"year": 2019, "cause": "Depressive disorders", "rate": 0},
        {"year": 2019, "cause": "Migraine", "rate": 0},
        {"year": 2020, "cause": "Ischaemic heart disease", "rate": 96.92},
        {"year": 2020, "cause": "Stroke", "rate": 59.75},
        {"year": 2020, "cause": "Lower respiratory infections", "rate": 48.91},
        {"year": 2020, "cause": "Road injury", "rate": 14.07},
        {"year": 2020, "cause": "Diabetes mellitus", "rate": 13.52},
        {"year": 2020, "cause": "Back and neck pain", "rate": 0},
        {"year": 2020, "cause": "Kidney diseases", "rate": 19.66},
        {"year": 2020, "cause": "Skin diseases", "rate": 5.34},
        {"year": 2020, "cause": "Depressive disorders", "rate": 0},
        {"year": 2020, "cause": "Migraine", "rate": 0},
        {"year": 2021, "cause": "Ischaemic heart disease", "rate": 137.62},
        {"year": 2021, "cause": "COVID-19", "rate": 98.66},
        {"year": 2021, "cause": "Stroke", "rate": 69.08},
        {"year": 2021, "cause": "Lower respiratory infections", "rate": 57.22},
        {"year": 2021, "cause": "Road injury", "rate": 21.93},
        {"year": 2021, "cause": "Diabetes mellitus", "rate": 14.49},
        {"year": 2021, "cause": "Kidney diseases", "rate": 22.7},
        {"year": 2021, "cause": "Cirrhosis of the liver", "rate": 21.84},
        {"year": 2021, "cause": "Skin diseases", "rate": 5.04},
        {"year": 2021, "cause": "Chronic obstructive pulmonary disease", "rate": 25.64}
      ]
    },
    {
      "name": "data_0",
      "source": "data",
      "transform": [
        {
          "type": "window",
          "params": [null],
          "as": ["rank"],
          "ops": ["rank"],
          "fields": [""],
          "sort": {"field": ["rate"], "order": ["descending"]},
          "groupby": ["year"]
        }
      ]
    },
    {
      "name": "last_year_data",
      "source": "data_0",
      "transform": [
        {
          "type": "filter",
          "expr": "datum.year == 2021 || (datum.year == 2017 && (datum.cause == 'HIV/AIDS' || datum.cause == 'Lung cancers')) || (datum.year == 2020 && datum.cause == 'Migraine')"
        }
      ]
    }
  ],
  "marks": [
    {
      "name": "layer_0_pathgroup",
      "type": "group",
      "from": {
        "facet": {
          "name": "faceted_path_layer_0_main",
          "data": "data_0",
          "groupby": ["cause"]
        }
      },
      "encode": {
        "update": {
          "width": {"field": {"group": "width"}},
          "height": {"field": {"group": "height"}}
        }
      },
      "marks": [
        {
          "name": "layer_0_marks",
          "type": "line",
          "style": ["line"],
          "sort": {"field": "datum[\"year\"]"},
          "from": {"data": "faceted_path_layer_0_main"},
          "encode": {
            "update": {
              "stroke": {
                "scale": "color",
                "field": "cause",
                "value": {
                  "signal": "datum.cause === 'Ischaemic heart disease' || datum.cause === 'Kidney diseases' || datum.cause === 'Cirrhosis of the liver' ? '#FFB6C1' : (datum.cause === 'Diabetes mellitus' ? '#FF0000' : '#D3D3D3')"
                }
              },
              "description": {
                "signal": "\"year: \" + datum[\"year\"] + \"; rank: \" + datum[\"rank\"] + \"; cause: \" + datum[\"cause\"]"
              },
              "x": {"scale": "x", "field": "year"},
              "y": {"scale": "y", "field": "rank"}
            }
          }
        },
        {
          "name": "layer_0_text",
          "type": "text",
          "from": {"data": "last_year_data"},
          "encode": {
            "update": {
              "text": {"field": "cause"},
              "x": {"scale": "x", "field": "year", "offset": 5},
              "y": {"scale": "y", "field": "rank"},
              "align": {"value": "left"},
              "baseline": {"value": "middle"},
              "fill": {
                "scale": "color",
                "field": "cause",
                "value": {
                  "signal": "datum.cause === 'Ischaemic heart disease' || datum.cause === 'Kidney diseases' || datum.cause === 'Cirrhosis of the liver' ? '#FFB6C1' : (datum.cause === 'Diabetes mellitus' ? '#FF0000' : '#D3D3D3')"
                }
              }
            }
          }
        }
      ]
    },
    {
      "name": "layer_1_marks",
      "type": "symbol",
      "style": ["point"],
      "from": {"data": "data_0"},
      "encode": {
        "update": {
          "opacity": {"value": 1},
          "fill": {
            "scale": "color",
            "field": "cause",
            "value": {
              "signal": "datum.cause === 'Ischaemic heart disease' || datum.cause === 'Kidney diseases' || datum.cause === 'Cirrhosis of the liver' ? '#FFB6C1' : (datum.cause === 'Diabetes mellitus' ? '#FF0000' : '#D3D3D3')"
            }
          },
          "ariaRoleDescription": {"value": "point"},
          "description": {
            "signal": "\"year: \" + datum[\"year\"] + \"; rank: \" + datum[\"rank\"] + \"; cause: \" + datum[\"cause\"]"
          },
          "x": {"scale": "x", "field": "year"},
          "y": {"scale": "y", "field": "rank"}
        }
      }
    }
  ],
  "scales": [
    {
      "name": "x",
      "type": "point",
      "domain": {"data": "data_0", "field": "year", "sort": true},
      "range": [0, {"signal": "width"}],
      "padding": 0.5
    },
    {
      "name": "y",
      "type": "point",
      "domain": {"data": "data_0", "field": "rank", "sort": true},
      "range": [0, {"signal": "height"}],
      "padding": 0.5
    },
    {
      "name": "color",
      "type": "ordinal",
      "domain": [
        "Ischaemic heart disease", 
        "Kidney diseases", 
        "Cirrhosis of the liver", 
        "Diabetes mellitus",
        "Stroke",
        "Lower respiratory infections",
        "Road injury",
        "Back and neck pain",
        "Skin diseases",
        "Depressive disorders",
        "Migraine",
        "COVID-19",
        "Chronic obstructive pulmonary disease",
        "Lung cancers",
        "HIV/AIDS"
      ],
      "range": [
        "#FFB6C1", 
        "#FFB6C1", 
        "#FFB6C1", 
        "#FF0000",
        "#D3D3D3",
        "#D3D3D3",
        "#D3D3D3",
        "#D3D3D3",
        "#D3D3D3",
        "#D3D3D3",
        "#D3D3D3",
        "#D3D3D3",
        "#D3D3D3",
        "#D3D3D3",
        "#D3D3D3"
      ]
    }
  ],
  "axes": [
    {
      "scale": "x",
      "orient": "bottom",
      "grid": false,
      "title": "Year",
      "labelOverlap": true,
      "zindex": 0
    },
    {
      "scale": "y",
      "orient": "left",
      "grid": false,
      "title": "Rank",
      "zindex": 0
    }
  ]
}